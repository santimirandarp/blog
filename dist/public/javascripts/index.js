const toggler=e=>{""==e.style.display||"none"==e.style.display?e.style.display="block":e.style.display="none"},form=document.getElementById("comments_form"),toggleForm=document.getElementById("comments_toggleForm"),commentList=document.getElementById("comments_commentList"),moreComments=document.getElementById("comments_moreComments"),comment=({name:e,msg:t,isPublic:o})=>{return`<li class="comments_message ${o?"comments_message-preview":null}">`+`<p class="small" style="${o?"display:block":"display:none"}">Success! Comment will be public shortly (this is a preview).</p> <h3>${e}</h3><p>${t}</p>`+"</li>"},post=async e=>{const t=await fetch("/comments",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",redirect:"follow",referrerPolicy:"no-referrer",body:new FormData(e)});return t.json()},postMsg=e=>{e.preventDefault(),post(form).then(e=>{commentList.insertAdjacentHTML("beforebegin",comment(e))}).catch(e=>console.log(e))},skipLimit=e=>[e,e+10],get=async e=>{e=`comments/${e[0]}/${e[1]}`;const t=await fetch(e,{method:"GET",mode:"cors",cache:"no-cache",credentials:"same-origin",redirect:"follow",referrerPolicy:"no-referrer"});return t.json()};window.addEventListener("load",e=>get(skipLimit(0)).then(e=>{e.forEach(e=>{console.log(e),commentList.insertAdjacentHTML("beforeend",comment(e))})}).catch(e=>console.log(e))),moreComments.addEventListener("click",e=>{var t=commentList.children.length;console.log("nOfComments is ",t),get(skipLimit(t)).then(e=>commentList.insertAdjacentHTML("beforeend",comment(e))).catch(e=>console.log(e))}),toggleForm.addEventListener("click",()=>toggler(form)),form.addEventListener("submit",postMsg);const spans=document.querySelectorAll(".places .reviewSpan");spans.forEach(o=>{o.addEventListener("click",e=>{var t=o.nextElementSibling;toggler(t)})});